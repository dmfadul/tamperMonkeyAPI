<!doctype html>
<html lang="en">
<meta charset="utf-8">
<title>Simple Editor</title>
<style>
  body { font-family: sans-serif; margin: 2em; max-width: 600px; }
  select, textarea, button { display: block; width: 100%; margin: 1em 0; }
  textarea { height: 300px; font-family: monospace; }
  #msg { color: #555; }
</style>

<h2>Data Editor</h2>

<select id="fileSelect">
    <option disabled selected>Loading options...</option>
</select>

<textarea id="editor" placeholder="File content will appear here..." ></textarea>

<button id="saveBtn">Save changes</button>

<p id="msg">Ready</p>

<script>
const BASE = "";
const sel = document.getElementById("fileSelect");
const editor = document.getElementById("editor");
const msg = document.getElementById("msg");
const saveBtn = document.getElementById("saveBtn");
let FUNCTIONS_ARRAY = [];


// --- Load functions list ---
async function loadFunctions() {
    const path = "/raw/data/";
    try {
        const res = await fetch(BASE + path);
        if (!res.ok) throw new Error(`Error fetching data: ${res.statusText}`);
        FUNCTIONS_ARRAY = await res.json();
        sel.innerHTML = "";
        FUNCTIONS_ARRAY.forEach((f, index) => {
            const opt = document.createElement("option");
            opt.value = index;
            opt.textContent = f.name;
            sel.appendChild(opt);
        });
        
    } catch (e) {
        console.error("Error:", e);
        msg.textContent = "Error: " + e.message;
        return;
    }
}

// --- Save edited content ---
saveBtn.onclick = async () => {
    const path = "/raw/data/";

    try {
        const res = await fetch(BASE + path, {
            method: "GET",
            headers: { "content-type": "application/json" }
        });
        if (!res.ok) throw new Error(`Error fetching data: ${res.statusText}`);
        console.log("Data fetched successfully.", await res.json());
    } catch (error) {
        console.error("Error:", error);
        alert("Failed to save changes.");
    }

};

// --- Initialize ---
loadFunctions();

</script>
</html>